#!/usr/bin/perl -w

use strict;
use JSON;
use Time::HiRes qw (sleep);
use Data::Dumper;
use Getopt::Long;
use lib './lib';
use Minecraft::Automation;
use Minecraft::FileIO;
use Minecraft::UserInteraction;
$main::config = Minecraft::FileIO::read_config();
my $total_crafted = 0;
my $craft = '';
GetOptions(
    "craft=s" => \$craft,
    "help"    => \&help
    ) or die("Что то не так с опциями командной строки\n");

sub help
{
  print <<_HELP_;
Использование: craft <options>
Опции:
  --craft=строка  Что надо скрафтить.
      Ячейки инвертаря/стола крафта нумеруются с нуля, верхняя левая ячейка - 0:0, формат x:y
      Всё крафтится на столе крафта.
      Доступно:
      sea_lantern - морской фонарь
        Сначала возьмите 20 кристаллов (shift+click),
        они займут нижние ячейки инвертаря, остальное заполните осколками
      jack_lantern - Светильник Джека (из тыквы)
        Крафтится из палок, угля и тыкв
        0:0-8:0 пусто
        0:1-7:1 и 0:2-7:2 - тыквы
        0:3-3:3 - палки и 4:3-4:7 - уголь
      cube3x3 и cube2x2 - Объединение чего нибудь одинакового. Например слитки в куб
        Нужен полный инвертарь исходников
      paper - Крафт бумаги из тростника
        Нужен полный инвертарь исходников
      enhance - Улучшение чего нибудь. Например золотая морковь
        Каждая строка ячеек инверторя заполняется так:
        0-7 то что надо уложить на столе крафта вокруг
        шмота в 8 ячейке
      chest - Крафт сундуков сразу из брёвен (не досок)
        Заполните самый нижний ряд инвертаря брёвнами
      tnt - Крафт динамита
        Сначала возьмите 20 пороха (shift+click),
        они займут нижние ячейки инвертаря, остальное заполните песком
      book - крафт книг из кожи и тростника
        Самый нижний ряд заполните кожей, остальное тростником
      repeater - крафт краснокаменного повторителя
        В инвертаре с 0:0 по 2:3 камень, с 3:0 по 5:3 краснопыль, с 6:0 по 7:3 палки
      comparator - Крафт краснокаменного компаратора
        В основном инвертаре 3х3 идет камень, красная пыль, палки
        В руках первые три ячейки - кварц
      map - Крафт пустой карты + бумага
        Нижние два ряда заполнить тростником
        В нулевом и первом ряду - по 4 стека слитков железа и по 1 стеку красной пыли
      piston - Крафт поршня
        0:0-2:3 - доски, 3:0-6:6 - булыжник,
        7:0-7:3 - красная пыль и 8:0-8:3 - железные слитки
      hopper - Крафт воронки из железных слитков и брёвен
        0:0-4:3 - железные слитки, 5:0-6:8 - брёвна
      slab - Крафт плит
        0:2-8:3 - исходники, из которых крафтятся плиты
      decor - Крафт декоративных блоков, которые обычно крафтятся из плит одна над другой
        0:2-8:3 - исходники, из которых крафтятся плиты
        То есть для декоративного песчанника нужен обычный песчанник
_HELP_
  exit(0);
}

sub move_stack_from_craft_result
{
  Minecraft::Automation::take_stack_to_invertory($main::config->{'system'}{'crafttable'}{'result'});
  $total_crafted++;
  Minecraft::UserInteraction::say("%d шт. готово.", $total_crafted);
}

for my $reciept_file (Minecraft::FileIO::get_items())
{
  print Dumper (Minecraft::FileIO::read_item_file($reciept_file))
}

# for ($craft)
# {
#   if     (/cube2x2/)      {           }
#   elsif  (/cube3x3/)      {           }
#   else            { help();                    }
#
# }
# ---------------------------------------- новое ----------------------------------------------------
